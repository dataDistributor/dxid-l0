# Minimal test Dockerfile
FROM rust:1.75.0

WORKDIR /app

# Copy only essential files
COPY Cargo.toml Cargo.lock ./
COPY dxid-node/Cargo.toml dxid-node/
COPY dxid-runtime/Cargo.toml dxid-runtime/
COPY dxid-crypto/Cargo.toml dxid-crypto/
COPY dxid-smt/Cargo.toml dxid-smt/
COPY dxid-p2p/Cargo.toml dxid-p2p/

# Create dummy source files to satisfy cargo
RUN mkdir -p dxid-node/src dxid-runtime/src dxid-crypto/src dxid-smt/src dxid-p2p/src
RUN echo 'fn main() { println!("Hello, world!"); }' > dxid-node/src/main.rs
RUN echo 'pub fn dummy() {}' > dxid-runtime/src/lib.rs
RUN echo 'pub fn dummy() {}' > dxid-crypto/src/lib.rs
RUN echo 'pub fn dummy() {}' > dxid-smt/src/lib.rs
RUN echo 'pub fn dummy() {}' > dxid-p2p/src/lib.rs

# Try to build
RUN cargo build --release --package dxid-node
